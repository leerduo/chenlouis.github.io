
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Adding an Easy Share Action | louis.chen</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="louis.chen">
    
    <meta name="description" content="Implementing an effective and user friendly share action in your[ActionBar](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/an">
    
    
    
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="louis.chen" title="louis.chen"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="louis.chen">louis.chen</a></h1>
				<h2 class="blog-motto">Mobile developers,experience extreme product.</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					
						<li><a href="/">博客</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/03/18/adding-an-easy-share-action/" title="Adding an Easy Share Action" itemprop="url">Adding an Easy Share Action</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://yoursite.com" title="louis.chen">louis.chen</a>
    </p>
  <p class="article-time">
    <time datetime="2015-03-18T00:47:25.000Z" itemprop="datePublished">2015-03-18</time>
    更新日期:<time datetime="2015-04-20T07:21:35.638Z" itemprop="dateModified">2015-04-20</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Update_Menu_Declarations"><span class="toc-number">1.</span> <span class="toc-text">Update Menu Declarations</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Set_the_Share_Intent"><span class="toc-number">2.</span> <span class="toc-text">Set the Share Intent</span></a></li></ol>
		</div>
		
		<p>Implementing an effective and user friendly share action in your<code>[ActionBar](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/app/ActionBar.html)</code> is made even easier with the introduction of<code>[ActionProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/view/ActionProvider.html)</code> in Android 4.0 (API Level 14). An <code>[ActionProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/view/ActionProvider.html)</code>, once attached to a menu item in the action bar, handles both the appearance and behavior of that item. In the case of<code>[ShareActionProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ShareActionProvider.html)</code>, you provide a share intent and it does the rest.</p>
<p><strong>Note: </strong> <code>[ShareActionProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ShareActionProvider.html)</code> is available starting with API Level 14 and higher.</p>
<div><img src="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/images/ui/actionbar-shareaction.png" alt=""></div>

<h2 id="Update_Menu_Declarations">Update Menu Declarations</h2><hr>
<p>To get started with <code>[ShareActionProviders](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ShareActionProvider.html)</code>, define the<code>android:actionProviderClass</code> attribute for the corresponding <code>&amp;lt;item&amp;gt;</code> in your<a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/guide/topics/resources/menu-resource.html" target="_blank" rel="external">menu resource</a> file:</p>
<p>[xml]&lt;menu xmlns:android=&quot;<a href="http://schemas.android.com/apk/res/android&quot;&amp;gt" target="_blank" rel="external">http://schemas.android.com/apk/res/android&quot;&amp;gt</a>;<br>&lt;item<br>android:id=&quot;@+id/menu_item_share&quot;<br>android:showAsAction=&quot;ifRoom&quot;<br>android:title=&quot;Share&quot;<br>&lt;strong&gt;android:actionProviderClass=<br>&quot;android.widget.ShareActionProvider&quot;&lt;/strong&gt; /&gt;<br>…<br>&lt;/menu&gt;[/xml]</p>
<p>This delegates responsibility for the item’s appearance and function to<code>[ShareActionProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ShareActionProvider.html)</code>. However, you will need to tell the provider what you would like to share.</p>
<h2 id="Set_the_Share_Intent">Set the Share Intent</h2><hr>
<p>In order for <code>[ShareActionProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ShareActionProvider.html)</code> to function, you must provide it a share intent. This share intent should be the same as described in the <a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/training/sharing/send.html" target="_blank" rel="external">Sending Simple Data to Other Apps</a> lesson, with action <code>[ACTION_SEND](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/content/Intent.html#ACTION_SEND)</code> and additional data set via extras like <code>[EXTRA_TEXT](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/content/Intent.html#EXTRA_TEXT)</code> and <code>[EXTRA_STREAM](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/content/Intent.html#EXTRA_STREAM)</code>. To assign a share intent, first find the corresponding <code>[MenuItem](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/view/MenuItem.html)</code>while inflating your menu resource in your <code>[Activity](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/app/Activity.html)</code> or <code>[Fragment](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/app/Fragment.html)</code>. Next, call <code>[MenuItem.getActionProvider()](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/view/MenuItem.html#getActionProvider())</code> to retrieve an instance of <code>[ShareActionProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ShareActionProvider.html)</code>. Use <code>[setShareIntent()](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ShareActionProvider.html#setShareIntent(android.content.Intent))</code> to update the share intent associated with that action item. Here’s an example:</p>
<p>[java]private ShareActionProvider mShareActionProvider;<br>…</p>
<p>@Override<br>public boolean onCreateOptionsMenu(Menu menu) {<br>// Inflate menu resource file.<br>getMenuInflater().inflate(R.menu.share_menu, menu);</p>
<p>// Locate MenuItem with ShareActionProvider<br>MenuItem item = menu.findItem(R.id.menu_item_share);</p>
<p>// Fetch and store ShareActionProvider<br>mShareActionProvider = (ShareActionProvider) item.getActionProvider();</p>
<p>// Return true to display menu<br>return true;<br>}</p>
<p>// Call to update the share intent<br>private void setShareIntent(Intent shareIntent) {<br>if (mShareActionProvider != null) {<br>mShareActionProvider.setShareIntent(shareIntent);<br>}<br>}[/java]</p>
<p>You may only need to set the share intent once during the creation of your menus, or you may want to set it and then update it as the UI changes. For example, when you view photos full screen in the Gallery app, the sharing intent changes as you flip between photos.</p>
<p>For further discussion about the <code>[ShareActionProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ShareActionProvider.html)</code> object, see the <a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/guide/topics/ui/actionbar.html#ActionProvider" target="_blank" rel="external">Action Bar</a> guide.</p>
  
	</div>
		<footer class="article-footer clearfix">


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Training文档/">Training文档</a>
</div>



<div class="article-share" id="share">

  <div data-url="http://yoursite.com/2015/03/18/adding-an-easy-share-action/" data-title="Adding an Easy Share Action | louis.chen" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/03/20/sharing-files/" title="Sharing Files">
  <strong>PREVIOUS:</strong><br/>
  <span>
  Sharing Files</span>
</a>
</div>


<div class="next">
<a href="/2015/03/18/receiving-simple-data-from-other-apps/"  title="Receiving Simple Data from Other Apps">
 <strong>NEXT:</strong><br/> 
 <span>Receiving Simple Data from Other Apps
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Update_Menu_Declarations"><span class="toc-number">1.</span> <span class="toc-text">Update Menu Declarations</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Set_the_Share_Intent"><span class="toc-number">2.</span> <span class="toc-text">Set the Share Intent</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/Android开发/" title="Android开发">Android开发<sup>21</sup></a></li>
		
			<li><a href="/categories/Android开源框架/" title="Android开源框架">Android开源框架<sup>4</sup></a></li>
		
			<li><a href="/categories/Android开发/Dandelion/" title="Dandelion">Dandelion<sup>1</sup></a></li>
		
			<li><a href="/categories/Java/" title="Java">Java<sup>1</sup></a></li>
		
			<li><a href="/categories/Android开发/Training文档/" title="Training文档">Training文档<sup>9</sup></a></li>
		
			<li><a href="/categories/Training文档/" title="Training文档">Training文档<sup>9</sup></a></li>
		
			<li><a href="/categories/blog/" title="blog">blog<sup>1</sup></a></li>
		
			<li><a href="/categories/未分类/" title="未分类">未分类<sup>0</sup></a></li>
		
			<li><a href="/categories/自定义控件/" title="自定义控件">自定义控件<sup>4</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/博客/" title="博客">博客<sup>1</sup></a></li>
		
			<li><a href="/tags/文章/" title="文章">文章<sup>1</sup></a></li>
		
		</ul>
</div>


  <div class="rsspart">
	<a href="null" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> louis.chen,student of USTC,Focus on mobile develop. <br/>
			It is my amibition to develop beautiful app.</p>
	</section>
	 
	<div class="social-font clearfix">
		
		<a href="http://weibo.com/2338582935" target="_blank" title="weibo"></a>
		
		
		
		<a href="https://github.com/leerduo" target="_blank" title="github"></a>
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2015 
		
		<a href="http://yoursite.com" target="_blank" title="louis.chen">louis.chen</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"null"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 





  </body>
</html>
