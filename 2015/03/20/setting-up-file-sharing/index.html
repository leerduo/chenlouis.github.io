
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Setting Up File Sharing | louis.chen</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="louis.chen">
    
    <meta name="description" content="To securely offer a file from your app to another app, you need to configure your app to offer a secure handle to the file, in the form of a content U">
    
    
    
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="louis.chen" title="louis.chen"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="louis.chen">louis.chen</a></h1>
				<h2 class="blog-motto">Mobile developers,experience extreme product.</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					
						<li><a href="/">博客</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/03/20/setting-up-file-sharing/" title="Setting Up File Sharing" itemprop="url">Setting Up File Sharing</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://yoursite.com" title="louis.chen">louis.chen</a>
    </p>
  <p class="article-time">
    <time datetime="2015-03-20T00:20:42.000Z" itemprop="datePublished">2015-03-20</time>
    更新日期:<time datetime="2015-04-20T07:21:35.638Z" itemprop="dateModified">2015-04-20</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Specify_the_FileProvider"><span class="toc-number">1.</span> <span class="toc-text">Specify the FileProvider</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Specify_Sharable_Directories"><span class="toc-number">2.</span> <span class="toc-text">Specify Sharable Directories</span></a></li></ol>
		</div>
		
		<p>To securely offer a file from your app to another app, you need to configure your app to offer a secure handle to the file, in the form of a content URI. The Android<code>[FileProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/support/v4/content/FileProvider.html)</code> component generates content URIs for files, based on specifications you provide in XML. This lesson shows you how to add the default implementation of<code>[FileProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/support/v4/content/FileProvider.html)</code> to your app, and how to specify the files you want to offer to other apps.</p>
<p><strong>Note:</strong> The <code>[FileProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/support/v4/content/FileProvider.html)</code> class is part of the <a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/tools/support-library/features.html#v4" target="_blank" rel="external">v4 Support Library</a>. For information about including this library in your application, see <a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/tools/support-library/setup.html" target="_blank" rel="external">Support Library Setup</a>.</p>
<h2 id="Specify_the_FileProvider">Specify the FileProvider</h2><hr>
<p>Defining a <code>[FileProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/support/v4/content/FileProvider.html)</code> for your app requires an entry in your manifest. This entry specifies the authority to use in generating content URIs, as well as the name of an XML file that specifies the directories your app can share.</p>
<p>The following snippet shows you how to add to your manifest the <code>[&amp;lt;provider&amp;gt;](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/guide/topics/manifest/provider-element.html)</code> element that specifies the <code>[FileProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/support/v4/content/FileProvider.html)</code> class, the authority, and the XML file name:</p>
<p>[xml]&lt;manifest xmlns:android=&quot;<a href="http://schemas.android.com/apk/res/android&amp;quot" target="_blank" rel="external">http://schemas.android.com/apk/res/android&amp;quot</a>;<br>package=&quot;com.example.myapp&quot;&gt;<br>&lt;application<br>…&gt;<br>&lt;provider<br>android:name=&quot;android.support.v4.content.FileProvider&quot;<br>android:authorities=&quot;com.example.myapp.fileprovider&quot;<br>android:grantUriPermissions=&quot;true&quot;<br>android:exported=&quot;false&quot;&gt;<br>&lt;meta-data<br>android:name=&quot;android.support.FILE_PROVIDER_PATHS&quot;<br>android:resource=&quot;@xml/filepaths&quot; /&gt;<br>&lt;/provider&gt;<br>…<br>&lt;/application&gt;<br>&lt;/manifest&gt;[/xml]</p>
<p>In this example, the <code>[android:authorities](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/guide/topics/manifest/provider-element.html#auth)</code> <span style="color: #333399;">attribute specifies the URI authority that you want to use for content URIs generated by the </span><code>[FileProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/support/v4/content/FileProvider.html)</code>. In the example, the authority is<code>com.example.myapp.fileprovider</code>. For your own app, specify an authority consisting of the app’s<code>[android:package](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/guide/topics/manifest/manifest-element.html#package)</code> value with the string “fileprovider” appended to it. To learn more about the authority value, see the topic <a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/guide/topics/providers/content-provider-basics.html#ContentURIs" target="_blank" rel="external">Content URIs</a> and the documentation for the <code>[android:authorities](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/guide/topics/manifest/provider-element.html#auth)</code>attribute.</p>
<p>The <code>[&amp;lt;meta-data&amp;gt;](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/guide/topics/manifest/meta-data-element.html)</code> child element of the <code>[&amp;lt;provider&amp;gt;](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/guide/topics/manifest/provider-element.html)</code> points to an XML file that specifies the directories you want to share. The <code>android:resource</code> attribute is the path and name of the file, without the <code>.xml</code>extension.The contents of this file are described in the next section.</p>
<h2 id="Specify_Sharable_Directories">Specify Sharable Directories</h2><hr>
<p>Once you have added the <code>[FileProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/support/v4/content/FileProvider.html)</code> to your app manifest, you need to specify the directories that contain the files you want to share. To specify the directories, start by creating the file<code>filepaths.xml</code> in the <code>res/xml/</code> subdirectory of your project. In this file, specify the directories by adding an XML element for each directory. The following snippet shows you an example of the contents of <code>res/xml/filepaths.xml</code>. The snippet also demonstrates how to share a subdirectory of the <code>files/</code>directory in your internal storage area:</p>
<p>[xml]&lt;paths&gt;<br>&lt;files-path path=&quot;images/&quot; name=&quot;myimages&quot; /&gt;<br>&lt;/paths&gt;[/xml]</p>
<p>In this example, the <code>&amp;lt;files-path&amp;gt;</code> tag shares directories within the <code>files/</code> directory of your app’s internal storage. The <code>path</code> attribute shares the <code>images/</code> subdirectory of <code>files/</code>. The <code>name</code> attribute tells the <code>[FileProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/support/v4/content/FileProvider.html)</code> to add the path segment <code>myimages</code> to content URIs for files in the<code>files/images/</code> subdirectory.</p>
<p>The <code>&amp;lt;paths&amp;gt;</code> element can have multiple children, each specifying a different directory to share. In addition to the <code>&amp;lt;files-path&amp;gt;</code> element, you can use the <code>&amp;lt;external-path&amp;gt;</code> element to share directories in external storage, and the <code>&amp;lt;cache-path&amp;gt;</code> element to share directories in your internal cache directory. To learn more about the child elements that specify shared directories, see the<code>[FileProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/support/v4/content/FileProvider.html)</code> reference documentation.</p>
<p><strong>Note:</strong> The XML file is the only way you can specify the directories you want to share; you can’t programmatically add a directory.</p>
<p>You now have a complete specification of a <code>[FileProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/support/v4/content/FileProvider.html)</code> that generates content URIs for files in the<code>files/</code> directory of your app’s internal storage or for files in subdirectories of <code>files/</code>. When your app generates a content URI for a file, it contains the authority specified in the <code>[&amp;lt;provider&amp;gt;](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/guide/topics/manifest/provider-element.html)</code>element (<code>com.example.myapp.fileprovider</code>), the path <code>myimages/</code>, and the name of the file.</p>
<p>For example, if you define a <code>[FileProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/support/v4/content/FileProvider.html)</code> according to the snippets in this lesson, and you request a content URI for the file <code>default_image.jpg</code>, <code>[FileProvider](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/support/v4/content/FileProvider.html)</code> returns the following URI:</p>
<p>[java]content://com.example.myapp.fileprovider/myimages/default_image.jpg[/java]</p>
  
	</div>
		<footer class="article-footer clearfix">


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Training文档/">Training文档</a>
</div>



<div class="article-share" id="share">

  <div data-url="http://yoursite.com/2015/03/20/setting-up-file-sharing/" data-title="Setting Up File Sharing | louis.chen" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/03/23/creating-a-navigation-drawer/" title="Creating a Navigation Drawer">
  <strong>PREVIOUS:</strong><br/>
  <span>
  Creating a Navigation Drawer</span>
</a>
</div>


<div class="next">
<a href="/2015/03/20/sharing-files/"  title="Sharing Files">
 <strong>NEXT:</strong><br/> 
 <span>Sharing Files
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Specify_the_FileProvider"><span class="toc-number">1.</span> <span class="toc-text">Specify the FileProvider</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Specify_Sharable_Directories"><span class="toc-number">2.</span> <span class="toc-text">Specify Sharable Directories</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/Android开发/" title="Android开发">Android开发<sup>21</sup></a></li>
		
			<li><a href="/categories/Android开源框架/" title="Android开源框架">Android开源框架<sup>4</sup></a></li>
		
			<li><a href="/categories/Android开发/Dandelion/" title="Dandelion">Dandelion<sup>1</sup></a></li>
		
			<li><a href="/categories/Java/" title="Java">Java<sup>1</sup></a></li>
		
			<li><a href="/categories/Android开发/Training文档/" title="Training文档">Training文档<sup>9</sup></a></li>
		
			<li><a href="/categories/Training文档/" title="Training文档">Training文档<sup>9</sup></a></li>
		
			<li><a href="/categories/blog/" title="blog">blog<sup>1</sup></a></li>
		
			<li><a href="/categories/未分类/" title="未分类">未分类<sup>0</sup></a></li>
		
			<li><a href="/categories/自定义控件/" title="自定义控件">自定义控件<sup>4</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/博客/" title="博客">博客<sup>1</sup></a></li>
		
			<li><a href="/tags/文章/" title="文章">文章<sup>1</sup></a></li>
		
		</ul>
</div>


  <div class="rsspart">
	<a href="null" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> louis.chen,student of USTC,Focus on mobile develop. <br/>
			It is my amibition to develop beautiful app.</p>
	</section>
	 
	<div class="social-font clearfix">
		
		<a href="http://weibo.com/2338582935" target="_blank" title="weibo"></a>
		
		
		
		<a href="https://github.com/leerduo" target="_blank" title="github"></a>
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2015 
		
		<a href="http://yoursite.com" target="_blank" title="louis.chen">louis.chen</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"null"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 





  </body>
</html>
