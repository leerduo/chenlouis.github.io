
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>contextual action mode | louis.chen</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="louis.chen">
    
    <meta name="description" content="在Google的开发文档的guide的menu里面，提到上下文菜单的两种形式。
There are two ways to provide contextual actions:

In a floating context menu. A menu appears as a floating li">
    
    
    
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="louis.chen" title="louis.chen"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="louis.chen">louis.chen</a></h1>
				<h2 class="blog-motto">Mobile developers,experience extreme product.</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					
						<li><a href="/">博客</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/01/29/contextual-action-mode/" title="contextual action mode" itemprop="url">contextual action mode</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://yoursite.com" title="louis.chen">louis.chen</a>
    </p>
  <p class="article-time">
    <time datetime="2015-01-29T02:27:18.000Z" itemprop="datePublished">2015-01-29</time>
    更新日期:<time datetime="2015-04-20T07:21:35.634Z" itemprop="dateModified">2015-04-20</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
		</div>
		
		<p>在Google的开发文档的guide的menu里面，提到上下文菜单的两种形式。</p>
<p>There are two ways to provide contextual actions:</p>
<ul>
<li>In a <a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/guide/topics/ui/menus.html#FloatingContextMenu" target="_blank" rel="external">floating context menu</a>. A menu appears as a floating list of menu items (similar to a dialog) when the user performs a long-click (press and hold) on a view that declares support for a context menu. Users can perform a contextual action on one item at a time.</li>
<li>In the <a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/guide/topics/ui/menus.html#CAB" target="_blank" rel="external">contextual action mode</a>. This mode is a system implementation of <code>[ActionMode](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/view/ActionMode.html)</code> that displays a contextual action bar at the top of the screen with action items that affect the selected item(s). When this mode is active, users can perform an action on multiple items at once (if your app allows it).<br>一种是：浮动的上下文菜单，这也是我们经常用到的。</li>
</ul>
<p>一种是：contextual action mode</p>
<p>效果图如下：</p>
<p><img src="http://img.blog.csdn.net/20150129101927320?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmZ1ZHVvX2xvdmVpdA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>&nbsp;</p>
<p>contextual action mode即是右边的那幅图。</p>
<p>我实现的效果如下图：</p>
<p><img src="http://img.blog.csdn.net/20150129102049703?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2hlbmZ1ZHVvX2xvdmVpdA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<ol>
<li>Implement the <code>[ActionMode.Callback](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/view/ActionMode.Callback.html)</code> interface. In its callback methods, you can specify the actions for the contextual action bar, respond to click events on action items, and handle other lifecycle events for the action mode.</li>
<li>Call <code>[startActionMode()](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/app/Activity.html#startActionMode(android.view.ActionMode.Callback))</code> when you want to show the bar (such as when the user long-clicks the view).<br>也就是说第一步需要实现<a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/view/ActionMode.Callback.html" target="_blank" rel="external">ActionMode.Callback</a> 这样的接口。第二步调用<code>[startActionMode()](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/app/Activity.html#startActionMode(android.view.ActionMode.Callback))</code> 方法。</li>
</ol>
<p>&nbsp;</p>
<p>第一步：</p>
<p>[codesyntax lang=”java”]</p>
<pre> 

<p>private ActionMode mActionMode;</p>
<pre><code><span class="keyword">private</span> ActionMode.Callback mActionModeCallback = <span class="keyword">new</span> ActionMode.Callback() {
    <span class="comment">// Called each time the action mode is shown. Always called after</span>
    <span class="comment">// onCreateActionMode, but</span>
    <span class="comment">// may be called multiple times if the mode is invalidated.</span>
    <span class="annotation">@Override</span>
    <span class="keyword">public</span> <span class="typename">boolean</span> onPrepareActionMode(ActionMode mode, Menu menu) {
        <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// Return false if nothing is done</span>
    }

    <span class="comment">// Called when the action mode is created; startActionMode() was called</span>
    <span class="annotation">@Override</span>
    <span class="keyword">public</span> <span class="typename">boolean</span> onCreateActionMode(ActionMode mode, Menu menu) {
        <span class="comment">// Inflate a menu resource providing context menu items</span>
        MenuInflater inflater = mode.getMenuInflater();
        inflater.inflate(R.menu.game_menu, menu);
        <span class="keyword">return</span> <span class="literal">true</span>;
    }

    <span class="annotation">@Override</span>
    <span class="keyword">public</span> <span class="typename">void</span> onDestroyActionMode(ActionMode mode) {
         mActionMode = <span class="literal">null</span>;
    }

    <span class="annotation">@Override</span>
    <span class="keyword">public</span> <span class="typename">boolean</span> onActionItemClicked(ActionMode mode, MenuItem item) {
        <span class="typename">int</span> id = item.getItemId();

        <span class="keyword">return</span> <span class="literal">false</span>;
    }
};&lt;/pre&gt;
</code></pre><p>[/codesyntax]</p>
<p>第二步：</p>
<p>[codesyntax lang=”java”]</p>
<p><pre><br>mActionMode = startActionMode(mActionModeCallback);<br>        mActionMode.setTitle(“title”);</pre><br>[/codesyntax]<br>指定样式：</p>
<p>[codesyntax lang=”xml”]</p>
<p><pre>  &lt;style name=”MyActionBarTheme” parent=”@style/Theme.AppCompat.Light”&gt;<br>        &lt;item name=”android:actionBarStyle”&gt;@style/MyActionBar&lt;/item&gt;<br>        &lt;item name=”android:actionModeBackground”&gt;@android:color/holo_orange_light&lt;/item&gt;</pre></p>
<pre><code>    <span class="subst">&amp;</span><span class="literal">lt</span>;<span class="subst">!--</span> ActionMode右边的按钮是一个特殊的CloseButton，分割线与CloseButton的Style有关 <span class="subst">--&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;<span class="subst">!--</span> 删除ActionMode的Divider<span class="subst">--&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;item name<span class="subst">=</span><span class="string">"android:actionModeCloseButtonStyle"</span><span class="subst">&amp;</span><span class="literal">gt</span>;@<span class="built_in">null</span><span class="subst">&amp;</span><span class="literal">lt</span>;/item<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;/style<span class="subst">&amp;</span><span class="literal">gt</span>;

<span class="subst">&amp;</span><span class="literal">lt</span>;style name<span class="subst">=</span><span class="string">"MyActionBar"</span> <span class="keyword">parent</span><span class="subst">=</span><span class="string">"@style/Widget.AppCompat.ActionBar"</span><span class="subst">&amp;</span><span class="literal">gt</span>;
    <span class="subst">&amp;</span><span class="literal">lt</span>;item name<span class="subst">=</span><span class="string">"android:background"</span><span class="subst">&amp;</span><span class="literal">gt</span>;@android:color/holo_green_light<span class="subst">&amp;</span><span class="literal">lt</span>;/item<span class="subst">&amp;</span><span class="literal">gt</span>;
<span class="subst">&amp;</span><span class="literal">lt</span>;/style<span class="subst">&amp;</span><span class="literal">gt</span>;<span class="subst">&lt;</span>/pre<span class="subst">&gt;</span>
</code></pre><p>[/codesyntax]</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</pre>  
	</div>
		<footer class="article-footer clearfix">


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android开发/">Android开发</a>
</div>



<div class="article-share" id="share">

  <div data-url="http://yoursite.com/2015/01/29/contextual-action-mode/" data-title="contextual action mode | louis.chen" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/01/31/displaying-bitmaps-efficiently/" title="Displaying Bitmaps Efficiently">
  <strong>PREVIOUS:</strong><br/>
  <span>
  Displaying Bitmaps Efficiently</span>
</a>
</div>


<div class="next">
<a href="/2015/01/28/borderless-button/"  title="Borderless button">
 <strong>NEXT:</strong><br/> 
 <span>Borderless button
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/Android开发/" title="Android开发">Android开发<sup>21</sup></a></li>
		
			<li><a href="/categories/Android开源框架/" title="Android开源框架">Android开源框架<sup>4</sup></a></li>
		
			<li><a href="/categories/Android开发/Dandelion/" title="Dandelion">Dandelion<sup>1</sup></a></li>
		
			<li><a href="/categories/Java/" title="Java">Java<sup>1</sup></a></li>
		
			<li><a href="/categories/Android开发/Training文档/" title="Training文档">Training文档<sup>9</sup></a></li>
		
			<li><a href="/categories/Training文档/" title="Training文档">Training文档<sup>9</sup></a></li>
		
			<li><a href="/categories/blog/" title="blog">blog<sup>1</sup></a></li>
		
			<li><a href="/categories/未分类/" title="未分类">未分类<sup>0</sup></a></li>
		
			<li><a href="/categories/自定义控件/" title="自定义控件">自定义控件<sup>4</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/博客/" title="博客">博客<sup>1</sup></a></li>
		
			<li><a href="/tags/文章/" title="文章">文章<sup>1</sup></a></li>
		
		</ul>
</div>


  <div class="rsspart">
	<a href="null" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> louis.chen,student of USTC,Focus on mobile develop. <br/>
			It is my amibition to develop beautiful app.</p>
	</section>
	 
	<div class="social-font clearfix">
		
		<a href="http://weibo.com/2338582935" target="_blank" title="weibo"></a>
		
		
		
		<a href="https://github.com/leerduo" target="_blank" title="github"></a>
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2015 
		
		<a href="http://yoursite.com" target="_blank" title="louis.chen">louis.chen</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"null"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 





  </body>
</html>
