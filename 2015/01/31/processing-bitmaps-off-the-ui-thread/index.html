
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Processing Bitmaps Off the UI Thread | louis.chen</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="louis.chen">
    
    <meta name="description" content="The [BitmapFactory.decode*](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/graphics/BitmapFactory.html#decodeByteArra">
    
    
    
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="louis.chen" title="louis.chen"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="louis.chen">louis.chen</a></h1>
				<h2 class="blog-motto">Mobile developers,experience extreme product.</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					
						<li><a href="/">博客</a></li>
					
						<li><a href="/archives">归档</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/01/31/processing-bitmaps-off-the-ui-thread/" title="Processing Bitmaps Off the UI Thread" itemprop="url">Processing Bitmaps Off the UI Thread</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://yoursite.com" title="louis.chen">louis.chen</a>
    </p>
  <p class="article-time">
    <time datetime="2015-01-31T03:59:00.000Z" itemprop="datePublished">2015-01-31</time>
    更新日期:<time datetime="2015-04-20T07:21:35.635Z" itemprop="dateModified">2015-04-20</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Use_an_AsyncTask"><span class="toc-number">1.</span> <span class="toc-text">Use an AsyncTask</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Handle_Concurrency"><span class="toc-number">2.</span> <span class="toc-text">Handle Concurrency</span></a></li></ol>
		</div>
		
		<p>The <code>[BitmapFactory.decode*](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/graphics/BitmapFactory.html#decodeByteArray(byte[], int, int, android.graphics.BitmapFactory.Options))</code> methods, discussed in the <a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/training/displaying-bitmaps/load-bitmap.html" target="_blank" rel="external">Load Large Bitmaps Efficiently</a> lesson, should not be executed on the main UI thread if the source data is read from disk or a network location (or really any source other than memory). The time this data takes to load is unpredictable and depends on a variety of factors (speed of reading from disk or network, size of image, power of CPU, etc.). If one of these tasks blocks the UI thread, the system flags your application as non-responsive and the user has the option of closing it (see <a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/guide/practices/responsiveness.html" target="_blank" rel="external">Designing for Responsiveness</a> for more information).</p>
<p>This lesson walks you through processing bitmaps in a background thread using <code>[AsyncTask](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/os/AsyncTask.html)</code> and shows you how to handle concurrency issues.</p>
<p>译：</p>
<p>在上一课中有介绍一系列的<a href="http://developer.android.com/reference/android/graphics/BitmapFactory.html#decodeByteArray(byte[], int, int, android.graphics.BitmapFactory.Options" target="_blank" rel="external">BitmapFactory.decode*</a>) 方法，当数据源是网络或者是磁盘时(或者是任何实际源不在内存的)，这些方法都不应该在main UI 线程中执行。那些情况下加载数据是不可以预知的，它依赖于许多因素(从网络或者硬盘读取数据的速度, 图片的大小, CPU的速度, etc.)。如果其中任何一个任务卡住了UI thread, 系统会出现ANR的错误。</p>
<p>这一节课会介绍如何使用 AsyncTask 在后台线程中处理bitmap并且演示了如何处理并发(concurrency)的问题。</p>
<h2 id="Use_an_AsyncTask">Use an AsyncTask</h2><hr>
<p>The <code>[AsyncTask](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/os/AsyncTask.html)</code> class provides an easy way to execute some work in a background thread and publish the results back on the UI thread. To use it, create a subclass and override the provided methods. Here’s an example of loading a large image into an <code>[ImageView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ImageView.html)</code> using <code>[AsyncTask](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/os/AsyncTask.html)</code> and <a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/training/displaying-bitmaps/load-bitmap.html#decodeSampledBitmapFromResource" target="_blank" rel="external"><code>decodeSampledBitmapFromResource()</code></a>:</p>
<p>译：</p>
<p><a href="http://developer.android.com/reference/android/os/AsyncTask.html" target="_blank" rel="external">AsyncTask</a> 类提供了一个简单的方法来在后台线程执行一些操作，并且可以把后台的结果呈现到UI线程。下面是一个加载大图的示例：</p>
<p>[java]<br>&lt;pre&gt;class BitmapWorkerTask extends AsyncTask&lt;Integer, Void, Bitmap&gt; {<br>    private final WeakReference&lt;ImageView&gt; imageViewReference;<br>    private int data = 0;</p>
<pre><code><span class="function"><span class="keyword">public</span> <span class="title">BitmapWorkerTask</span><span class="params">(ImageView imageView)</span> </span>{
    <span class="comment">// Use a WeakReference to ensure the ImageView can be garbage collected</span>
    imageViewReference = <span class="keyword">new</span> WeakReference&amp;lt;ImageView&amp;gt;(imageView);
}

<span class="comment">// Decode image in background.</span>
<span class="annotation">@Override</span>
<span class="keyword">protected</span> <span class="function">Bitmap <span class="title">doInBackground</span><span class="params">(Integer... params)</span> </span>{
    data = params[<span class="number">0</span>];
    <span class="keyword">return</span> decodeSampledBitmapFromResource(getResources(), data, <span class="number">100</span>, <span class="number">100</span>));
}

<span class="comment">// Once complete, see if ImageView is still around and set bitmap.</span>
<span class="annotation">@Override</span>
<span class="keyword">protected</span> <span class="function"><span class="keyword">void</span> <span class="title">onPostExecute</span><span class="params">(Bitmap bitmap)</span> </span>{
    <span class="keyword">if</span> (imageViewReference != <span class="keyword">null</span> &amp;amp;&amp;amp; bitmap != <span class="keyword">null</span>) {
        <span class="keyword">final</span> ImageView imageView = imageViewReference.get();
        <span class="keyword">if</span> (imageView != <span class="keyword">null</span>) {
            imageView.setImageBitmap(bitmap);
        }
    }
}
</code></pre><p>}&lt;/pre&gt;<br>[/java]</p>
<p>The <code>[WeakReference](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/java/lang/ref/WeakReference.html)</code> to the <code>[ImageView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ImageView.html)</code> ensures that the <code>[AsyncTask](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/os/AsyncTask.html)</code> does not prevent the <code>[ImageView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ImageView.html)</code> and anything it references from being garbage collected. There’s no guarantee the <code>[ImageView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ImageView.html)</code> is still around when the task finishes, so you must also check the reference in <code>[onPostExecute()](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/os/AsyncTask.html#onPostExecute(Result))</code>. The<code>[ImageView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ImageView.html)</code> may no longer exist, if for example, the user navigates away from the activity or if a configuration change happens before the task finishes.</p>
<p>To start loading the bitmap asynchronously, simply create a new task and execute it:</p>
<p>译：</p>
<p>为<a href="http://developer.android.com/reference/android/widget/ImageView.html" target="_blank" rel="external">ImageView</a>使用<a href="http://developer.android.com/reference/java/lang/ref/WeakReference.html" target="_blank" rel="external">WeakReference</a> 确保了 AsyncTask 所引用的资源可以被GC(garbage collected)。因为当任务结束时不能确保 <a href="http://developer.android.com/reference/android/widget/ImageView.html" target="_blank" rel="external">ImageView</a> 仍然存在，因此你必须在 onPostExecute() 里面去检查引用。这个ImageView 也许已经不存在了，例如，在任务结束时用户已经不在那个Activity或者是设备已经发生配置改变(旋转屏幕等)。</p>
<p>开始异步加载位图，只需要创建一个新的任务并执行它即可:</p>
<p>[java]<br>&lt;pre&gt;public void loadBitmap(int resId, ImageView imageView) {<br>    BitmapWorkerTask task = new BitmapWorkerTask(imageView);<br>    task.execute(resId);<br>}&lt;/pre&gt;<br>[/java]</p>
<h2 id="Handle_Concurrency">Handle Concurrency</h2><hr>
<p>Common view components such as <code>[ListView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ListView.html)</code> and <code>[GridView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/GridView.html)</code> introduce another issue when used in conjunction with the <code>[AsyncTask](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/os/AsyncTask.html)</code> as demonstrated in the previous section. In order to be efficient with memory, these components recycle child views as the user scrolls. If each child view triggers an <code>[AsyncTask](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/os/AsyncTask.html)</code>, there is no guarantee that when it completes, the associated view has not already been recycled for use in another child view. Furthermore, there is no guarantee that the order in which asynchronous tasks are started is the order that they complete.</p>
<p>注：这么的一段话，我不翻译了，翻译过来就变了味道。慢慢体会。</p>
<p>The blog post <a href="http://android-developers.blogspot.com/2010/07/multithreading-for-performance.html" target="_blank" rel="external">Multithreading for Performance</a> further discusses dealing with concurrency, and offers a solution where the <code>[ImageView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ImageView.html)</code> stores a reference to the most recent <code>[AsyncTask](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/os/AsyncTask.html)</code> which can later be checked when the task completes. Using a similar method, the <code>[AsyncTask](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/os/AsyncTask.html)</code> from the previous section can be extended to follow a similar pattern.</p>
<p>译：<a href="http://android-developers.blogspot.com/2010/07/multithreading-for-performance.html" target="_blank" rel="external">Multithreading for Performance</a> 这篇博文更进一步的讨论了如何处理并发并且提供了一种解决方法，当任务结束时ImageView 保存一个最近常使用的AsyncTask引用。使用类似的方法, AsyncTask 可以扩展出一个类似的模型。创建一个专用的 Drawable 子类来保存一个可以回到当前工作任务的引用。在这种情况下，BitmapDrawable 被用来作为占位图片，它可以在任务结束时显示到ImageView中。</p>
<p>注：上面的翻译始终感觉很挫。还是看英文吧。</p>
<p>Create a dedicated <code>[Drawable](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/graphics/drawable/Drawable.html)</code> subclass to store a reference back to the worker task. In this case, a<code>[BitmapDrawable](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/graphics/drawable/BitmapDrawable.html)</code> is used so that a placeholder image can be displayed in the <code>[ImageView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ImageView.html)</code> while the task completes:</p>
<p>译：</p>
<p>创建一个专用的<a href="http://developer.android.com/reference/android/graphics/drawable/Drawable.html" target="_blank" rel="external">Drawable</a>的子类来储存返回工作任务的引用。在这种情况下，当任务完成时<a href="http://developer.android.com/reference/android/graphics/drawable/BitmapDrawable.html" target="_blank" rel="external">BitmapDrawable</a>会被使用，placeholder image才会在<a href="http://developer.android.com/reference/android/widget/ImageView.html" target="_blank" rel="external">ImageView</a>中被显示:</p>
<p>[java]<br>&lt;pre&gt;static class AsyncDrawable extends BitmapDrawable {<br>    private final WeakReference&lt;BitmapWorkerTask&gt; bitmapWorkerTaskReference;</p>
<pre><code><span class="function"><span class="keyword">public</span> <span class="title">AsyncDrawable</span><span class="params">(Resources res, Bitmap bitmap,
        BitmapWorkerTask bitmapWorkerTask)</span> </span>{
    <span class="keyword">super</span>(res, bitmap);
    bitmapWorkerTaskReference =
        <span class="keyword">new</span> WeakReference&amp;lt;BitmapWorkerTask&amp;gt;(bitmapWorkerTask);
}

<span class="keyword">public</span> <span class="function">BitmapWorkerTask <span class="title">getBitmapWorkerTask</span><span class="params">()</span> </span>{
    <span class="function"><span class="keyword">return</span> bitmapWorkerTaskReference.<span class="title">get</span><span class="params">()</span></span>;
}
</code></pre><p>}&lt;/pre&gt;<br>[/java]</p>
<p>Before executing the <a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/training/displaying-bitmaps/process-bitmap.html#BitmapWorkerTask" target="_blank" rel="external"><code>BitmapWorkerTask</code></a>, you create an <a href="file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/training/displaying-bitmaps/process-bitmap.html#AsyncDrawable" target="_blank" rel="external"><code>AsyncDrawable</code></a> and bind it to the target<code>[ImageView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ImageView.html)</code>:</p>
<p>[java]<br>&lt;pre&gt;public void loadBitmap(int resId, ImageView imageView) {<br>    if (cancelPotentialWork(resId, imageView)) {<br>        final BitmapWorkerTask task = new BitmapWorkerTask(imageView);<br>        final AsyncDrawable asyncDrawable =<br>                new AsyncDrawable(getResources(), mPlaceHolderBitmap, task);<br>        imageView.setImageDrawable(asyncDrawable);<br>        task.execute(resId);<br>    }<br>}&lt;/pre&gt;<br>[/java]</p>
<p>The <code>cancelPotentialWork</code> method referenced in the code sample above checks if another running task is already associated with the <code>[ImageView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ImageView.html)</code>. If so, it attempts to cancel the previous task by calling<code>[cancel()](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/os/AsyncTask.html#cancel(boolean))</code>. In a small number of cases, the new task data matches the existing task and nothing further needs to happen. Here is the implementation of <code>cancelPotentialWork</code>:</p>
<p>[java]<br>&lt;pre&gt;public static boolean cancelPotentialWork(int data, ImageView imageView) {<br>    final BitmapWorkerTask bitmapWorkerTask = getBitmapWorkerTask(imageView);</p>
<pre><code><span class="keyword">if</span> (bitmapWorkerTask != <span class="keyword">null</span>) {
    <span class="keyword">final</span> <span class="keyword">int</span> bitmapData = bitmapWorkerTask.data;
    <span class="comment">// If bitmapData is not yet set or it differs from the new data</span>
    <span class="keyword">if</span> (bitmapData == <span class="number">0</span> || bitmapData != data) {
        <span class="comment">// Cancel previous task</span>
        bitmapWorkerTask.cancel(<span class="keyword">true</span>);
    } <span class="keyword">else</span> {
        <span class="comment">// The same work is already in progress</span>
        <span class="keyword">return</span> <span class="keyword">false</span>;
    }
}
<span class="comment">// No task associated with the ImageView, or an existing task was cancelled</span>
<span class="keyword">return</span> <span class="keyword">true</span>;
</code></pre><p>}&lt;/pre&gt;<br>[/java]</p>
<p>A helper method, <code>getBitmapWorkerTask()</code>, is used above to retrieve the task associated with a particular <code>[ImageView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ImageView.html)</code>:</p>
<p>[java]<br>&lt;pre&gt;private static BitmapWorkerTask getBitmapWorkerTask(ImageView imageView) {<br>   if (imageView != null) {<br>       final Drawable drawable = imageView.getDrawable();<br>       if (drawable instanceof AsyncDrawable) {<br>           final AsyncDrawable asyncDrawable = (AsyncDrawable) drawable;<br>           return asyncDrawable.getBitmapWorkerTask();<br>       }<br>    }<br>    return null;<br>}&lt;/pre&gt;<br>[/java]</p>
<p>[java]<br>&lt;pre&gt;class BitmapWorkerTask extends AsyncTask&lt;Integer, Void, Bitmap&gt; {<br>…</p>
<p>@Override<br>protected void onPostExecute(Bitmap bitmap) {<br>&lt;strong&gt;if (isCancelled()) {<br>bitmap = null;<br>}&lt;/strong&gt;</p>
<p>if (imageViewReference != null &amp;&amp; bitmap != null) {<br>final ImageView imageView = imageViewReference.get();<br>&lt;strong&gt;final BitmapWorkerTask bitmapWorkerTask =<br>getBitmapWorkerTask(imageView);&lt;/strong&gt;<br>if (&lt;strong&gt;this == bitmapWorkerTask &amp;&amp;&lt;/strong&gt; imageView != null) {<br>imageView.setImageBitmap(bitmap);<br>}<br>}<br>}<br>}<br>[/java]</p>
<p>This implementation is now suitable for use in <code>[ListView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ListView.html)</code> and <code>[GridView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/GridView.html)</code> components as well as any other components that recycle their child views. Simply call <code>loadBitmap</code> where you normally set an image to your <code>[ImageView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/ImageView.html)</code>. For example, in a <code>[GridView](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/GridView.html)</code> implementation this would be in the <code>[getView()](file:///D:/Users/Administrator/AppData/Local/Android/sdk/docs/reference/android/widget/Adapter.html#getView(int, android.view.View, android.view.ViewGroup))</code> method of the backing adapter.</p>
<p>译：</p>
<p>这个方法不仅仅适用于 ListView 与 GridView 组件，在那些需要循环利用子视图的组件中同样适用。只需要在设置图片到ImageView的地方调用 <code>loadBitmap</code> 方法。例如，在GridView 中实现这个方法会是在 getView() 方法里面调用。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
  
	</div>
		<footer class="article-footer clearfix">


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android开发/">Android开发</a>
</div>



<div class="article-share" id="share">

  <div data-url="http://yoursite.com/2015/01/31/processing-bitmaps-off-the-ui-thread/" data-title="Processing Bitmaps Off the UI Thread | louis.chen" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/02/02/caching-bitmaps/" title="Caching Bitmaps">
  <strong>PREVIOUS:</strong><br/>
  <span>
  Caching Bitmaps</span>
</a>
</div>


<div class="next">
<a href="/2015/01/31/loading-large-bitmaps-efficiently/"  title="Loading Large Bitmaps Efficiently">
 <strong>NEXT:</strong><br/> 
 <span>Loading Large Bitmaps Efficiently
</span>
</a>
</div>

</nav>

	
<section class="comment">
	<div class="ds-thread"></div>
</section>

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Use_an_AsyncTask"><span class="toc-number">1.</span> <span class="toc-text">Use an AsyncTask</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Handle_Concurrency"><span class="toc-number">2.</span> <span class="toc-text">Handle Concurrency</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/Android开发/" title="Android开发">Android开发<sup>21</sup></a></li>
		
			<li><a href="/categories/Android开源框架/" title="Android开源框架">Android开源框架<sup>4</sup></a></li>
		
			<li><a href="/categories/Android开发/Dandelion/" title="Dandelion">Dandelion<sup>1</sup></a></li>
		
			<li><a href="/categories/Java/" title="Java">Java<sup>1</sup></a></li>
		
			<li><a href="/categories/Android开发/Training文档/" title="Training文档">Training文档<sup>9</sup></a></li>
		
			<li><a href="/categories/Training文档/" title="Training文档">Training文档<sup>9</sup></a></li>
		
			<li><a href="/categories/blog/" title="blog">blog<sup>1</sup></a></li>
		
			<li><a href="/categories/未分类/" title="未分类">未分类<sup>0</sup></a></li>
		
			<li><a href="/categories/自定义控件/" title="自定义控件">自定义控件<sup>4</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/博客/" title="博客">博客<sup>1</sup></a></li>
		
			<li><a href="/tags/文章/" title="文章">文章<sup>1</sup></a></li>
		
		</ul>
</div>


  <div class="rsspart">
	<a href="null" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> louis.chen,student of USTC,Focus on mobile develop. <br/>
			It is my amibition to develop beautiful app.</p>
	</section>
	 
	<div class="social-font clearfix">
		
		<a href="http://weibo.com/2338582935" target="_blank" title="weibo"></a>
		
		
		
		<a href="https://github.com/leerduo" target="_blank" title="github"></a>
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/A-limon/pacman" target="_blank" title="Pacman">Pacman</a> © 2015 
		
		<a href="http://yoursite.com" target="_blank" title="louis.chen">louis.chen</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>


<script type="text/javascript">
  var duoshuoQuery = {short_name:"null"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 





  </body>
</html>
